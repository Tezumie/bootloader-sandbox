(()=>{if(window.__BootloaderSandboxInit)return;window.__BootloaderSandboxInit=!0;const e=window.BootloaderSandboxConfig||{},t=!1!==e.cache,n="bldr_seed",a="bldr_iter",r='\n:root{\n  /* Light theme (default) */\n  --fg:#111; --bg:#fff; --muted:#666; --border:#111;\n  --btn-bg:#fff; --btn-bg-hover:#f3f3f3; --btn-bg-active:#e9e9e9;\n  --input-bg:#fff;\n  --veil:rgba(255,255,255,0.6);\n  --focus:#111;\n}\n:root[data-theme="dark"]{\n  --fg:#eee; --bg:#111; --muted:#aaa; --border:#333;\n  --btn-bg:#1b1b1b; --btn-bg-hover:#222; --btn-bg-active:#262626;\n  --input-bg:#0f0f0f;\n  --veil:rgba(255,255,255,0.3);\n  --focus:#eee;\n}\n\n*{box-sizing:border-box} html,body{height:100%}\nbody{\n  margin:0; background:var(--bg); display:flex; flex-direction:column;\n  font-family:"IBM Plex Mono", monospace; font-size:14px;\n}\n\n/* Header */\n.head{\n  background:var(--bg); color:var(--fg); border-bottom:1px solid var(--border);\n  margin:0; padding:8px 10px; display:flex; align-items:center; gap:12px; user-select:none;\n}\n.head .title{ font-weight:500; letter-spacing:.02em; margin-right:auto; }\n.head .label{ color:var(--muted); margin-left:6px; margin-right:4px; }\n\n/* Inputs */\n.head .input{\n  height:24px; padding:2px 6px; font:inherit; color:var(--fg);\n  background:var(--input-bg); border:1px solid var(--border); width:90px; padding-right:22px;\n}\n.head #iter{ width:64px; }\n.head .input:focus{ outline:1px solid var(--focus); outline-offset:-1px; }\n\n.input-wrap{ position:relative; display:inline-flex; align-items:center; }\n.clearbtn{\n  position:absolute; right:6px; top:calc(50% - 6px); transform:translateY(-50%);\n  width:16px; height:16px; line-height:16px; border:0; background:transparent; color:var(--muted);\n  cursor:pointer; padding:0; font:22px/1 "IBM Plex Mono", monospace; opacity:0; pointer-events:none;\n}\n.input-wrap:focus-within.has-value .clearbtn{ opacity:1; pointer-events:auto; }\n.clearbtn:hover{ color:var(--fg); }\n\n/* Header buttons */\n.head .iconbtn{\n  width:28px; height:28px; padding:0; display:inline-grid; place-items:center;\n  background:var(--btn-bg); color:var(--fg); border:1px solid var(--border); cursor:pointer;\n}\n.head .iconbtn:hover{ background:var(--btn-bg-hover); }\n.head .iconbtn:active{ background:var(--btn-bg-active); }\n.head .icon{\n  width:16px; height:16px; stroke:currentColor; fill:none; stroke-width:2; vector-effect:non-scaling-stroke;\n}\n\n/* Stage */\n#stage-wrap{ position:relative; flex:1; min-height:0; margin:0; background:var(--bg); }\n#stage-mask{\n  position:absolute; inset:0; background:var(--veil);\n  opacity:0; pointer-events:none;\n}\n#stage-wrap.is-loading #stage-mask{ opacity:1; }\n#stage{ width:100%; height:100%; display:block; border:0; background:transparent; }\n  '.trim();function o(){return t?{seed:localStorage.getItem(n),iter:localStorage.getItem(a)}:{seed:null,iter:null}}function i(e,r){t&&(null!=e&&localStorage.setItem(n,String(e)),null!=r&&localStorage.setItem(a,String(r)))}function l(e){const t=e.closest(".input-wrap");t&&(e.value&&String(e.value).length?t.classList.add("has-value"):t.classList.remove("has-value"))}async function s(){const t="string"==typeof e.source&&e.source.trim()?e.source.trim():"sketch.js";try{const e=await fetch(t,{cache:"no-store"});if(!e.ok)throw new Error(String(e.status));return await e.text()}catch{const e="script.js",n=await fetch(e,{cache:"no-store"});if(!n.ok)throw new Error(`Failed to fetch source: ${t} AND ${e}`);return await n.text()}}function d(e){const t=document.createElement("template");return t.innerHTML=e.trim(),t.content.firstElementChild}function c(){!function(){const t=e&&e.theme||"light",n=document.documentElement;"dark"===t?n.setAttribute("data-theme","dark"):n.removeAttribute("data-theme")}(),function(){if(!document.querySelector('link[href*="IBM+Plex+Mono"]')){const e=document.createElement("link");e.rel="stylesheet",e.href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;500;600;700&display=swap",document.head.appendChild(e)}}(),function(){const e=document.createElement("style");e.textContent=r,document.head.appendChild(e)}();const c=document.querySelector("main")||document.body,u=d('\n      <div class="head" role="toolbar" aria-label="Live Preview controls">\n        <div class="title">Live Preview</div>\n\n        <div class="label">iteration:</div>\n        <span class="input-wrap">\n          <input id="iter" class="input" type="text" value="0" min="0" />\n          <button type="button" class="clearbtn" data-target="iter" aria-label="Clear iteration">×</button>\n        </span>\n\n        <div class="label">seed:</div>\n        <span class="input-wrap">\n          <input id="seed" class="input" type="text" inputmode="numeric" pattern="[0-9]*" maxlength="6" value="0" title="6-digit numeric seed (e.g. 894188)" />\n          <button type="button" class="clearbtn" data-target="seed" aria-label="Clear seed">×</button>\n        </span>\n\n         <button id="randomSeed" class="iconbtn" title="Randomize seed">\n            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-dices" aria-hidden="true"><rect width="12" height="12" x="2" y="10" rx="2" ry="2"></rect><path d="m17.92 14 3.5-3.5a2.24 2.24 0 0 0 0-3l-5-4.92a2.24 2.24 0 0 0-3 0L10 6"></path><path d="M6 18h.01"></path><path d="M18 9h.01">>\n            </path><path d="M10 14h.01"></path><path d="M15 6h.01"></path>\n            </svg>\n       </button>\n\n        <button id="reload" class="iconbtn" title="Refresh preview">\n          <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true">\n            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>\n            <path d="M21 3v5h-5"></path>\n            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>\n            <path d="M8 16H3v5"></path>\n          </svg>\n        </button>\n      </div>\n    '),f=d('\n      <div id="stage-wrap">\n        <iframe id="stage" sandbox="allow-scripts"\n          allow="accelerometer; camera; gyroscope; microphone; xr-spatial-tracking; midi;"></iframe>\n        <div id="stage-mask" aria-hidden="true"></div>\n      </div>\n    ');c.prepend(f),c.prepend(u);const p=u.querySelector("#seed"),g=u.querySelector("#iter"),h=u.querySelector("#reload"),v=u.querySelector("#randomSeed"),b=f.querySelector("#stage"),m=new URLSearchParams(location.search),x=()=>f.classList.remove("is-loading");if(b.addEventListener("load",x),m.has("seed"))p.value=m.get("seed");else{const{seed:e}=o();e&&(p.value=e)}if(m.has("iter"))g.value=m.get("iter");else{const{iter:e}=o();e&&(g.value=e)}async function w(){try{f.classList.add("is-loading");const e=function(e,t,n){let a=0n;try{const e=String(t).replace(/\D+/g,"");a=BigInt(e||"0")}catch{}const r=encodeURIComponent(e);return"data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cscript%3E%3C!%5BCDATA%5Bconst%20SEED%3D"+a+"n%3Bfunction%20splitmix64(f)%7Blet%20n%3Df%3Breturn%20function()%7Blet%20f%3Dn%3Dn%2B0x9e3779b97f4a7c15n%260xffffffffffffffffn%3Breturn%20f%3D((f%3D(f%5Ef%3E%3E30n)*0xbf58476d1ce4e5b9n%260xffffffffffffffffn)%5Ef%3E%3E27n)*0x94d049bb133111ebn%260xffffffffffffffffn%2CNumber(4294967295n%26(f%5E%3Df%3E%3E31n))%3E%3E%3E0%7D%7Dfunction%20sfc32(f%2Cn%2C%24%2Ct)%7Breturn%20function()%7B%24%7C%3D0%3Blet%20e%3D((f%7C%3D0)%2B(n%7C%3D0)%7C0)%2B(t%7C%3D0)%7C0%3Breturn%20t%3Dt%2B1%7C0%2Cf%3Dn%5En%3E%3E%3E9%2Cn%3D%24%2B(%24%3C%3C3)%7C0%2C%24%3D(%24%3D%24%3C%3C21%7C%24%3E%3E%3E11)%2Be%7C0%2C(e%3E%3E%3E0)%2F4294967296%7D%7Dconst%20sm%3Dsplitmix64(SEED)%2Ca%3Dsm()%2Cb%3Dsm()%2Cc%3Dsm()%2Cd%3Dsm()%2Cn%3D"+Math.max(0,Number(n||0))+"%2CBTLDR%3D%7Brnd%3Asfc32(a%2Cb%2Cc%2Cd)%2Cseed%3ASEED%2CiterationNumber%3An%2CisPreview%3An%3D%3D%3D0%26%26SEED%3D%3D%3D0n%2Csvg%3Adocument.documentElement%2Cv%3A%27svg-js%3A0.0.1%27%7D%3B((BTLDR)%3D%3E%7B"+r+"%7D)(BTLDR)%3B%5D%5D%3E%3C%2Fscript%3E%3C%2Fsvg%3E"}(await s(),p.value,g.value);b.src=e}catch(e){x();const t=b.contentDocument||b.contentWindow?.document;t&&(t.open(),t.write(`<pre style="color:#333;background:#fafafa;padding:16px;margin:0;">${String(e).replace(/[&<>]/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;"}[e]))}</pre>`),t.close()),console.error(e)}}l(p),l(g);const C=function(e,t=250){let n;return(...a)=>{clearTimeout(n),n=setTimeout(()=>e(...a),t)}}(w,250);h.addEventListener("click",()=>{i(p.value,g.value),w()}),v.addEventListener("click",()=>{const e=Math.floor(1e5+9e5*Math.random()).toString();p.value=e,i(p.value,g.value),w()}),g.addEventListener("input",()=>{""!==g.value&&(g.value=String(Math.max(0,Math.floor(Number(g.value))))),i(p.value,g.value),l(g),C()}),p.addEventListener("input",()=>{p.value=p.value.replace(/\D+/g,"").slice(0,6),i(p.value,g.value),l(p),C()}),u.querySelectorAll(".clearbtn").forEach(e=>{e.addEventListener("click",()=>{const r=e.getAttribute("data-target"),o=u.querySelector("#"+r);var s;o&&(o.value="0",s="seed"===r?"seed":"iter",t&&("seed"===s&&localStorage.removeItem(n),"iter"===s&&localStorage.removeItem(a)),l(o),i(p.value,g.value),C(),o.focus())})}),window.BootloaderSandbox={render:w,get seed(){return p.value},set seed(e){p.value=String(e||0),i(p.value,g.value),C()},get iter(){return g.value},set iter(e){g.value=String(Math.max(0,Math.floor(Number(e||0)))),i(p.value,g.value),C()}},w()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c,{once:!0}):c()})();